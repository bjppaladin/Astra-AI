export const SKU_COST_MAP: Record<string, { name: string; cost: number }> = {
  "SPE_E5": { name: "Microsoft 365 E5", cost: 57.00 },
  "MICROSOFT 365 E5": { name: "Microsoft 365 E5", cost: 57.00 },
  "SPE_E3": { name: "Microsoft 365 E3", cost: 36.00 },
  "MICROSOFT 365 E3": { name: "Microsoft 365 E3", cost: 36.00 },
  "STANDARDPACK": { name: "Office 365 E1", cost: 10.00 },
  "OFFICE 365 E1": { name: "Office 365 E1", cost: 10.00 },
  "SPE_F1": { name: "Microsoft 365 F1", cost: 2.25 },
  "MICROSOFT 365 F1": { name: "Microsoft 365 F1", cost: 2.25 },
  "M365_F1": { name: "Microsoft 365 F1", cost: 2.25 },
  "M365_F1_COMM": { name: "Microsoft 365 F1", cost: 2.25 },
  "SPE_F5_SEC": { name: "Microsoft 365 F5 Security", cost: 12.00 },
  "SPE_F5_COMP": { name: "Microsoft 365 F5 Compliance", cost: 12.00 },
  "M365_F3": { name: "Microsoft 365 F3", cost: 8.00 },
  "DESKLESSPACK": { name: "Office 365 F3", cost: 4.00 },
  "ENTERPRISEPREMIUM": { name: "Office 365 E5", cost: 38.00 },
  "OFFICE 365 E5": { name: "Office 365 E5", cost: 38.00 },
  "ENTERPRISEPACK": { name: "Office 365 E3", cost: 23.00 },
  "OFFICE 365 E3": { name: "Office 365 E3", cost: 23.00 },
  "ENTERPRISEWITHSCAL": { name: "Office 365 E3", cost: 23.00 },

  "MICROSOFT 365 BUSINESS BASIC": { name: "Microsoft 365 Business Basic", cost: 6.00 },
  "O365_BUSINESS_ESSENTIALS": { name: "Microsoft 365 Business Basic", cost: 6.00 },
  "SMB_BUSINESS_ESSENTIALS": { name: "Microsoft 365 Business Basic", cost: 6.00 },
  "MICROSOFT 365 BUSINESS STANDARD": { name: "Microsoft 365 Business Standard", cost: 12.50 },
  "O365_BUSINESS_PREMIUM": { name: "Microsoft 365 Business Standard", cost: 12.50 },
  "SMB_BUSINESS_PREMIUM": { name: "Microsoft 365 Business Standard", cost: 12.50 },
  "O365_BUSINESS": { name: "Microsoft 365 Apps for business", cost: 12.50 },
  "MICROSOFT 365 BUSINESS PREMIUM": { name: "Microsoft 365 Business Premium", cost: 22.00 },
  "SPB": { name: "Microsoft 365 Business Premium", cost: 22.00 },
  "OFFICESUBSCRIPTION": { name: "Microsoft 365 Apps for enterprise", cost: 12.00 },
  "O365_BUSINESS_APPS": { name: "Microsoft 365 Apps for business", cost: 12.50 },

  "ATP_ENTERPRISE": { name: "Defender for Office 365 P1", cost: 2.00 },
  "ATP_ENTERPRISE_FACULTY": { name: "Defender for Office 365 P1", cost: 2.00 },
  "THREAT_INTELLIGENCE": { name: "Defender for Office 365 P2", cost: 5.00 },
  "WIN_DEF_ATP": { name: "Defender for Endpoint P2", cost: 5.20 },
  "DEFENDER_ENDPOINT_P1": { name: "Defender for Endpoint P1", cost: 3.00 },
  "MDE_SMB": { name: "Defender for Business", cost: 3.00 },
  "MDATP_XPLAT": { name: "Defender for Endpoint P2", cost: 5.20 },
  "ATA": { name: "Defender for Identity", cost: 5.50 },
  "DEFENDER_IDENTITY": { name: "Defender for Identity", cost: 5.50 },
  "ADALLOM_STANDALONE": { name: "Defender for Cloud Apps", cost: 3.50 },

  "EMS_E3": { name: "Enterprise Mobility + Security E3", cost: 11.60 },
  "EMS_E5": { name: "Enterprise Mobility + Security E5", cost: 16.40 },
  "EMSPREMIUM": { name: "Enterprise Mobility + Security E5", cost: 16.40 },
  "AAD_PREMIUM": { name: "Entra ID P1", cost: 6.00 },
  "AAD_PREMIUM_P2": { name: "Entra ID P2", cost: 9.00 },
  "INTUNE_A": { name: "Microsoft Intune Plan 1", cost: 8.00 },
  "INTUNE_SMB": { name: "Microsoft Intune Plan 1", cost: 8.00 },
  "RIGHTSMANAGEMENT": { name: "Azure Information Protection P1", cost: 2.00 },
  "RIGHTSMANAGEMENT_ADHOC": { name: "Rights Management Adhoc", cost: 0 },
  "RMS_S_PREMIUM": { name: "Azure Information Protection P1", cost: 2.00 },
  "RMS_S_PREMIUM2": { name: "Azure Information Protection P2", cost: 5.00 },

  "MCOEV": { name: "Teams Phone System", cost: 8.00 },
  "MCOEV_GOV": { name: "Teams Phone System", cost: 8.00 },
  "MCOEV_VIRTUALUSER": { name: "Teams Phone System Virtual User", cost: 0 },
  "PHONESYSTEM_VIRTUALUSER": { name: "Teams Phone System Virtual User", cost: 0 },
  "MCOPSTN1": { name: "Domestic Calling Plan", cost: 12.00 },
  "MCOPSTN2": { name: "International Calling Plan", cost: 24.00 },
  "MCOPSTN5": { name: "Domestic Calling Plan (120 min)", cost: 0 },
  "MCOMEETADV": { name: "Audio Conferencing", cost: 4.00 },
  "MICROSOFT_TEAMS_AUDIO_CONFERENCING_SELECT_DIAL_OUT": { name: "Audio Conferencing", cost: 0 },
  "MEETING_ROOM": { name: "Teams Rooms Standard", cost: 15.00 },
  "MTR_PREM": { name: "Teams Rooms Pro", cost: 40.00 },

  "WACONEDRIVEENTERPRISE": { name: "OneDrive for Business P2", cost: 0 },
  "WACONEDRIVESTANDARD": { name: "OneDrive for Business P1", cost: 5.00 },
  "SHAREPOINTENTERPRISE": { name: "SharePoint Online Plan 2", cost: 10.00 },
  "SHAREPOINTSTANDARD": { name: "SharePoint Online Plan 1", cost: 5.00 },

  "IDENTITY_THREAT_PROTECTION": { name: "Microsoft 365 E5 Security", cost: 12.00 },
  "IDENTITY_THREAT_PROTECTION_FOR_EMS_E5": { name: "Microsoft 365 E5 Security", cost: 12.00 },
  "INFORMATION_PROTECTION_COMPLIANCE": { name: "Microsoft 365 E5 Compliance", cost: 12.00 },
  "M365_SECURITY_COMPLIANCE_FOR_FLW": { name: "Microsoft 365 F5 Security + Compliance", cost: 12.00 },

  "VISIOCLIENT": { name: "Visio Plan 2", cost: 15.00 },
  "VISIO PLAN 2": { name: "Visio Plan 2", cost: 15.00 },
  "VISIO ONLINE PLAN 2": { name: "Visio Plan 2", cost: 15.00 },
  "VISIOONLINE_PLAN1": { name: "Visio Plan 1", cost: 5.00 },
  "PROJECTPREMIUM": { name: "Project Plan 5", cost: 55.00 },
  "PROJECT PLAN 5": { name: "Project Plan 5", cost: 55.00 },
  "PROJECTPROFESSIONAL": { name: "Project Plan 3", cost: 30.00 },
  "PROJECT PLAN 3": { name: "Project Plan 3", cost: 30.00 },
  "PROJECTESSENTIALS": { name: "Project Plan 1", cost: 10.00 },
  "PROJECT_P1": { name: "Project Plan 1", cost: 10.00 },

  "POWER_BI_PRO": { name: "Power BI Pro", cost: 10.00 },
  "POWER BI PRO": { name: "Power BI Pro", cost: 10.00 },
  "POWER_BI_PREMIUM_PER_USER": { name: "Power BI Premium Per User", cost: 20.00 },
  "PBI_PREMIUM_PER_USER": { name: "Power BI Premium Per User", cost: 20.00 },
  "POWER_BI_STANDARD": { name: "Power BI Free", cost: 0 },
  "POWERAPPS_PER_USER": { name: "Power Apps per user", cost: 20.00 },
  "POWERAPPS_PER_APP": { name: "Power Apps per app", cost: 5.00 },
  "POWER_AUTOMATE_PER_USER": { name: "Power Automate per user", cost: 15.00 },
  "FORMS_PRO": { name: "Dynamics 365 Customer Voice", cost: 0 },
  "CUSTOMER_VOICE": { name: "Dynamics 365 Customer Voice", cost: 0 },

  "MICROSOFT 365 COPILOT": { name: "Microsoft 365 Copilot", cost: 30.00 },
  "MICROSOFT_365_COPILOT": { name: "Microsoft 365 Copilot", cost: 30.00 },
  "Microsoft_365_Copilot": { name: "Microsoft 365 Copilot", cost: 30.00 },
  "GITHUB COPILOT": { name: "GitHub Copilot", cost: 20.00 },

  "EXCHANGESTANDARD": { name: "Exchange Online Plan 1", cost: 4.00 },
  "EXCHANGE ONLINE (PLAN 1)": { name: "Exchange Online Plan 1", cost: 4.00 },
  "EXCHANGEENTERPRISE": { name: "Exchange Online Plan 2", cost: 8.00 },
  "EXCHANGE ONLINE (PLAN 2)": { name: "Exchange Online Plan 2", cost: 8.00 },
  "EXCHANGEDESKLESS": { name: "Exchange Online Kiosk", cost: 2.00 },
  "EXCHANGE_S_ESSENTIALS": { name: "Exchange Online Essentials", cost: 2.00 },
  "EOP_ENTERPRISE": { name: "Exchange Online Protection", cost: 0 },

  "WIN10_PRO_ENT_SUB": { name: "Windows 10/11 Enterprise E3", cost: 7.00 },
  "WIN10_VDA_E5": { name: "Windows 10/11 Enterprise E5", cost: 11.00 },
  "WINDOWS_STORE": { name: "Windows Store for Business", cost: 0 },

  "CRMSTANDARD": { name: "Dynamics 365 Sales Professional", cost: 65.00 },
  "CRMENTERPRISE": { name: "Dynamics 365 Sales Enterprise", cost: 95.00 },
  "DYN365_ENTERPRISE_PLAN1": { name: "Dynamics 365 Plan", cost: 115.00 },
  "DYN365_TEAM_MEMBERS": { name: "Dynamics 365 Team Members", cost: 8.00 },

  "TEAMS_EXPLORATORY": { name: "Teams Exploratory", cost: 0 },
  "TEAMS_FREE": { name: "Microsoft Teams (Free)", cost: 0 },
  "FLOW_FREE": { name: "Power Automate Free", cost: 0 },
  "POWERAPPS_VIRAL": { name: "Power Apps Trial", cost: 0 },
  "STREAM": { name: "Microsoft Stream", cost: 0 },
  "STREAM_O365_E5": { name: "Microsoft Stream", cost: 0 },
  "CCIBOTS_PRIVPREV_VIRAL": { name: "Power Virtual Agents Trial", cost: 0 },
  "MICROSOFT_COMMUNICATION_COMPLIANCE": { name: "Communication Compliance", cost: 0 },
  "MCO_TEAMS_IW": { name: "Microsoft Teams Trial", cost: 0 },
  "POWER_AUTOMATE_ATTENDED_RPA": { name: "Power Automate RPA Attended", cost: 0 },
  "CLIPCHAMP": { name: "Microsoft Clipchamp", cost: 0 },
  "WINDOWS_AUTOPATCH": { name: "Windows Autopatch", cost: 0 },
};

export function findLicenseInfo(licenseName: string): { name: string; cost: number } {
  const trimmed = licenseName.trim();
  const upper = trimmed.toUpperCase();
  if (SKU_COST_MAP[upper]) return SKU_COST_MAP[upper];
  if (SKU_COST_MAP[trimmed]) return SKU_COST_MAP[trimmed];
  const underscoreNormalized = upper.replace(/_/g, " ");
  if (SKU_COST_MAP[underscoreNormalized]) return SKU_COST_MAP[underscoreNormalized];
  const noUnderscoreKey = upper.replace(/\s+/g, "_");
  if (SKU_COST_MAP[noUnderscoreKey]) return SKU_COST_MAP[noUnderscoreKey];
  for (const [key, val] of Object.entries(SKU_COST_MAP)) {
    if (upper.includes(key) || key.includes(upper)) return val;
  }
  for (const [key, val] of Object.entries(SKU_COST_MAP)) {
    const keyNorm = key.replace(/_/g, " ");
    if (upper.includes(keyNorm) || keyNorm.includes(upper)) return val;
  }
  return { name: trimmed, cost: 0 };
}
